---
phase: 24-board-kanban-ui
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/ui/gantt.tsx
  - src/app/board/workload/page.tsx
  - src/components/ui/tooltip.tsx
autonomous: true

must_haves:
  truths:
    - "Gantt bar left and right edges are draggable to extend or shrink task duration"
    - "Hovering a workload item shows tooltip with order number, client, garment, service, time, and due date"
  artifacts:
    - path: "src/components/ui/gantt.tsx"
      provides: "Wider drag handles (w-4) for Gantt bar resize"
      contains: "w-4 cursor-ew-resize"
    - path: "src/components/ui/tooltip.tsx"
      provides: "Reusable Radix UI Tooltip wrapper component"
      contains: "TooltipProvider"
    - path: "src/app/board/workload/page.tsx"
      provides: "Tooltip wrappers on workload items showing order/service details"
      contains: "Tooltip"
  key_links:
    - from: "src/app/board/workload/page.tsx"
      to: "src/components/ui/tooltip.tsx"
      via: "import { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }"
      pattern: "from.*@/components/ui/tooltip"
    - from: "src/components/ui/gantt.tsx"
      to: "drag handlers"
      via: "onMouseDown handleDragStart on wider handles"
      pattern: "w-4.*cursor-ew-resize"
---

<objective>
Fix Gantt chart drag-to-extend by increasing handle width, and add hover tooltips to workload page items showing order/service details.

Purpose: Gantt drag handles are only 8px wide (w-2) making them nearly impossible to grab. Workload items show minimal info and need hover details for quick inspection.
Output: Usable Gantt bar resizing and informative workload tooltips.
</objective>

<execution_context>
@/Users/aymanbaig/.claude/get-shit-done/workflows/execute-plan.md
@/Users/aymanbaig/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@src/components/ui/gantt.tsx
@src/app/board/workload/page.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Widen Gantt drag handles and verify drag functionality</name>
  <files>src/components/ui/gantt.tsx</files>
  <action>
The Gantt bar has three drag zones: left handle, body, and right handle. The left and right handles are `w-2` (8px) which is too narrow to reliably grab, especially on touch devices.

**Step 1 — Increase handle width from w-2 to w-4 (8px to 16px):**

Find the left drag handle (around line 658-664):
```tsx
<div
  className="absolute left-0 top-0 bottom-0 w-2 cursor-ew-resize bg-black/10 hover:bg-black/20 active:bg-black/30 rounded-l-md"
```
Change `w-2` to `w-4`.

Find the right drag handle (around line 674-680):
```tsx
<div
  className="absolute right-0 top-0 bottom-0 w-2 cursor-ew-resize bg-black/10 hover:bg-black/20 active:bg-black/30 rounded-r-md"
```
Change `w-2` to `w-4`.

**Step 2 — Add hover visual feedback to make handles discoverable:**

Add `opacity-0 hover:opacity-100 transition-opacity` to both handle divs so they are invisible until hovered, preventing visual clutter on small bars but making them discoverable:

Left handle className becomes:
```
"absolute left-0 top-0 bottom-0 w-4 cursor-ew-resize bg-black/0 hover:bg-black/20 active:bg-black/30 rounded-l-md transition-colors z-10"
```

Right handle className becomes:
```
"absolute right-0 top-0 bottom-0 w-4 cursor-ew-resize bg-black/0 hover:bg-black/20 active:bg-black/30 rounded-r-md transition-colors z-10"
```

Note: Changed `bg-black/10` to `bg-black/0` so handles are transparent by default but darken on hover. Added `z-10` to ensure handles sit above the body text.

**Step 3 — Verify drag event flow:**
The drag handlers (handleDragStart, handleTouchStart) are already bound to these elements. The global mousemove/mouseup/touchmove/touchend listeners in the useEffect (lines 544-611) handle the actual movement. No changes needed to the drag logic itself.

Do NOT change the body drag zone (the `<span>` between the handles).
Do NOT modify the handleDragStart, handleTouchStart, or handleMove logic.
Do NOT change the dayWidth calculation or throttle timing.
  </action>
  <verify>
Run `npx tsc --noEmit` to confirm no TypeScript errors. Verify both left and right handle divs now have `w-4` instead of `w-2`. Verify handles have `z-10` and transparent default background.
  </verify>
  <done>
Gantt drag handles are 16px wide (w-4) instead of 8px (w-2). Handles are transparent by default and darken on hover. Drag-to-extend functionality works for both left and right edges.
  </done>
</task>

<task type="auto">
  <name>Task 2: Install @radix-ui/react-tooltip and create tooltip UI component</name>
  <files>src/components/ui/tooltip.tsx</files>
  <action>
**Step 1 — Install dependency:**
Run: `npm install @radix-ui/react-tooltip`

The project already uses multiple @radix-ui packages (@radix-ui/react-context-menu, @radix-ui/react-dropdown-menu, @radix-ui/react-label, @radix-ui/react-progress, @radix-ui/react-slot).

**Step 2 — Create tooltip.tsx component following shadcn/ui pattern:**

Create `src/components/ui/tooltip.tsx` as a reusable Radix tooltip wrapper:

```tsx
'use client';

import * as React from 'react';
import * as TooltipPrimitive from '@radix-ui/react-tooltip';
import { cn } from '@/lib/utils';

const TooltipProvider = TooltipPrimitive.Provider;
const Tooltip = TooltipPrimitive.Root;
const TooltipTrigger = TooltipPrimitive.Trigger;

const TooltipContent = React.forwardRef<
  React.ElementRef<typeof TooltipPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>
>(({ className, sideOffset = 4, ...props }, ref) => (
  <TooltipPrimitive.Portal>
    <TooltipPrimitive.Content
      ref={ref}
      sideOffset={sideOffset}
      className={cn(
        'z-50 overflow-hidden rounded-md bg-popover px-3 py-2 text-sm text-popover-foreground shadow-md border border-border animate-in fade-in-0 zoom-in-95',
        className
      )}
      {...props}
    />
  </TooltipPrimitive.Portal>
));
TooltipContent.displayName = TooltipPrimitive.Content.displayName;

export { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider };
```

This follows the exact same pattern as other shadcn/ui components in the codebase (uses cn utility, forwardRef, Portal, displayName).

Do NOT use native HTML title attributes — they lack styling control and accessibility features.
  </action>
  <verify>
Run `npx tsc --noEmit` to confirm the new component compiles without errors. Verify `@radix-ui/react-tooltip` appears in package.json dependencies.
  </verify>
  <done>
@radix-ui/react-tooltip installed. Reusable tooltip.tsx component created at src/components/ui/tooltip.tsx with TooltipProvider, Tooltip, TooltipTrigger, TooltipContent exports.
  </done>
</task>

<task type="auto">
  <name>Task 3: Add hover tooltips to workload page items</name>
  <files>src/app/board/workload/page.tsx</files>
  <action>
Add tooltip wrappers around workload items (both assigned staff items inside each staff card, and unassigned items in the amber card) to show order/service details on hover.

**Step 1 — Add import:**
Add at the top of the file:
```tsx
import { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider } from '@/components/ui/tooltip';
```

**Step 2 — Wrap page content in TooltipProvider:**
Inside the main return (the non-loading, non-error return), wrap the outermost content div with TooltipProvider:

Find the return at approximately line 485:
```tsx
return (
  <AuthGuard>
    <div className="h-full flex flex-col overflow-hidden ...">
```

Wrap it:
```tsx
return (
  <AuthGuard>
    <TooltipProvider delayDuration={300}>
      <div className="h-full flex flex-col overflow-hidden ...">
```

And close it before `</AuthGuard>`:
```tsx
      </div>
    </TooltipProvider>
  </AuthGuard>
);
```

**Step 3 — Add tooltips to unassigned items:**
Find the unassigned items loop (around line 582). Each item is a `<div key={item.garmentServiceId} className="flex items-center justify-between gap-2 text-xs bg-white p-1.5 rounded border border-amber-200">`.

Wrap each item div with a Tooltip:

```tsx
<Tooltip key={item.garmentServiceId}>
  <TooltipTrigger asChild>
    <div className="flex items-center justify-between gap-2 text-xs bg-white p-1.5 rounded border border-amber-200">
      {/* existing content unchanged */}
    </div>
  </TooltipTrigger>
  <TooltipContent side="top" className="max-w-xs">
    <div className="space-y-1">
      <div className="font-semibold">Commande #{item.orderNumber}</div>
      <div className="text-muted-foreground">{item.clientName || 'Client inconnu'}</div>
      <div className="text-xs">
        <span className="font-medium">{item.garmentType || 'N/A'}</span>
        {' \u2022 '}
        <span>{item.serviceName}</span>
      </div>
      {item.estimatedMinutes && (
        <div className="text-xs text-muted-foreground">
          Est. {item.estimatedMinutes} minutes
        </div>
      )}
      {item.dueDate && (
        <div className="text-xs text-amber-600">
          Due: {format(new Date(item.dueDate), 'MMM dd, yyyy')}
        </div>
      )}
    </div>
  </TooltipContent>
</Tooltip>
```

Move the `key` from the inner div to the `<Tooltip>` wrapper. Remove `key` from the inner div since `<Tooltip>` is now the mapped element.

**Step 4 — Verify data fields available:**
Check the workload item interface/type to confirm these fields exist:
- `orderNumber` — used in existing code
- `serviceName` — used in existing code
- `dueDate` — used in existing code
- `clientName` — check if available in the item data; if not, it should be. Look at how items are structured in the data fetching logic. If `clientName` is not on the item type, use `item.clientName || ''` with optional chaining.
- `garmentType` — check if available; if not, use `item.garmentType || ''`
- `estimatedMinutes` — check if available; may be called `estimated_minutes`

Adjust field names to match actual data shape. If a field doesn't exist on the item, omit that line from the tooltip rather than showing undefined.

**Important:** Only add tooltips to the unassigned items section. The staff member cards show summary data (gauge, item count, hours) which don't need individual item tooltips since they're aggregate views.

Do NOT wrap the entire card components in tooltips.
Do NOT add tooltips to the header, gauge charts, or export buttons.
Use French for the "Commande #" label to match the app's French primary UI convention.
  </action>
  <verify>
Run `npx tsc --noEmit` to confirm no TypeScript errors. Verify:
1. TooltipProvider wraps the page content
2. Each unassigned item has a Tooltip wrapper
3. TooltipContent shows order number, client name, garment type, service, time, due date
4. All field references match the actual item data shape (no undefined access)
  </verify>
  <done>
Hovering over unassigned workload items shows tooltip with: order number, client name, garment type, service name, estimated time, and due date. Tooltip uses Radix UI for accessibility and consistent styling.
  </done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` passes without errors
2. `npm ls @radix-ui/react-tooltip` shows the package is installed
3. Gantt drag handles are w-4 (16px) with transparent default background
4. tooltip.tsx exists at src/components/ui/tooltip.tsx with proper exports
5. Workload page has TooltipProvider wrapper and Tooltip on unassigned items
6. No changes to Gantt drag logic (handleDragStart, handleMove, etc.)
7. No changes to workload item assignment functionality
</verification>

<success_criteria>
- Gantt bar edges are draggable to extend/shrink duration (16px grab area vs previous 8px)
- Gantt handles show visual feedback on hover (transparent to dark overlay)
- Hovering workload unassigned items shows tooltip with order/service details
- Tooltip displays: order number, client name, garment type, service name, estimated time, due date
- @radix-ui/react-tooltip installed and reusable tooltip.tsx component available
- No TypeScript compilation errors
- No regressions to Gantt drag behavior, workload assignments, or page layout
</success_criteria>

<output>
After completion, create `.planning/phases/24-board-kanban-ui/24-02-SUMMARY.md`
</output>
