---
phase: 23-full-en-fr-language-toggle
plan: 06
type: execute
wave: 3
depends_on: ["23-03", "23-04", "23-05"]
files_modified:
  - src/app/track/[id]/page.tsx
  - src/app/print/tasks/page.tsx
  - src/components/navigation/mobile-bottom-nav.tsx
  - src/components/navigation/role-based-nav.tsx
  - src/app/portal/page.tsx
  - locales/en.json
  - locales/fr.json
autonomous: false

must_haves:
  truths:
    - "Track page loading text uses t() call"
    - "Print tasks page loading text uses t() call"
    - "Mobile bottom nav labels (Board, Intake, Clients, Calendar) use t() calls"
    - "Role-based nav labels (Dashboard, Clients, Orders, etc.) use t() calls"
    - "Portal page status timeline, search, and error messages use t() calls"
    - "Zero hardcoded user-facing strings remain in any .tsx file across the entire codebase"
    - "en.json and fr.json have identical key structures after all additions"
    - "Language toggle works on every page — switching updates ALL visible text"
    - "Build passes with npm run build"
  artifacts:
    - path: "src/app/track/[id]/page.tsx"
      provides: "Translated track page"
      contains: "useTranslations|getTranslations"
    - path: "src/app/print/tasks/page.tsx"
      provides: "Translated print tasks page"
      contains: "useTranslations|getTranslations"
    - path: "src/components/navigation/mobile-bottom-nav.tsx"
      provides: "Translated mobile bottom navigation labels"
      contains: "useTranslations"
    - path: "src/components/navigation/role-based-nav.tsx"
      provides: "Translated role-based navigation labels"
      contains: "useTranslations"
    - path: "src/app/portal/page.tsx"
      provides: "Translated client portal page"
      contains: "useTranslations"
  key_links:
    - from: "All .tsx files"
      to: "locales/en.json + locales/fr.json"
      via: "useTranslations() / getTranslations()"
      pattern: "No hardcoded user-facing strings remain"
---

<objective>
Translate the remaining pages (track, print/tasks), perform a comprehensive sweep of ALL .tsx files for any missed hardcoded strings, fix any translation key gaps in the JSON files, and verify the complete i18n implementation with a build test.

Purpose: This is the final quality sweep. It catches anything missed by the previous plans, ensures JSON files are in sync, and validates the entire build passes.

Output: Zero hardcoded strings across the entire codebase, both JSON files in sync, build passes, and human verification of language toggle functionality.
</objective>

<execution_context>
@/Users/aymanbaig/.claude/get-shit-done/workflows/execute-plan.md
@/Users/aymanbaig/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/23-full-en-fr-language-toggle/23-RESEARCH.md
@.planning/phases/23-full-en-fr-language-toggle/23-03-SUMMARY.md
@.planning/phases/23-full-en-fr-language-toggle/23-04-SUMMARY.md
@.planning/phases/23-full-en-fr-language-toggle/23-05-SUMMARY.md

@src/app/track/[id]/page.tsx
@src/app/print/tasks/page.tsx
@locales/en.json
@locales/fr.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Translate remaining pages, navigation components, portal, and comprehensive codebase sweep</name>
  <files>
    src/app/track/[id]/page.tsx
    src/app/print/tasks/page.tsx
    src/components/navigation/mobile-bottom-nav.tsx
    src/components/navigation/role-based-nav.tsx
    src/app/portal/page.tsx
    locales/en.json
    locales/fr.json
  </files>
  <action>
    **Part A: Translate remaining pages**

    **src/app/track/[id]/page.tsx:**
    1. Add translation hook (useTranslations or getTranslations depending on component type)
    2. Replace "Chargement..." → `tc('loading')`
    3. Replace any other hardcoded strings (status labels, timeline labels, etc.)

    **src/app/print/tasks/page.tsx:**
    1. Add translation hook
    2. Replace "Chargement..." → `tc('loading')`
    3. Replace any other hardcoded strings (print labels, headers)

    **src/components/navigation/mobile-bottom-nav.tsx:**
    1. Add import: `import { useTranslations } from 'next-intl';`
    2. Add `const t = useTranslations('nav');` at top of component
    3. Replace hardcoded nav labels:
       - 'Board' → `t('board')`
       - 'Intake' → `t('intake')`
       - 'Clients' → `t('clients')`
       - 'Calendar' → `t('calendar')`
    4. Move the NAV_ITEMS array inside the component body (after the hook call) so t() can be used dynamically
    5. Add corresponding nav.* keys to both locale JSON files

    **src/components/navigation/role-based-nav.tsx:**
    1. Add import: `import { useTranslations } from 'next-intl';`
    2. Add `const t = useTranslations('nav');` at top of component
    3. Replace all hardcoded navigation labels:
       - 'Dashboard' → `t('dashboard')`
       - 'Clients' → `t('clients')`
       - 'Orders' → `t('orders')`
       - 'Garments' → `t('garments')`
       - 'Tasks' → `t('tasks')`
       - 'Services' → `t('services')`
       - 'Reports' → `t('reports')`
       - 'Settings' → `t('settings')`
    4. Move the nav items array inside the component body so t() can be used
    5. Update the filter logic that references label strings (e.g., `['Reports', 'Settings'].includes(item.label)`) to use a stable id field instead of translated labels

    **src/app/portal/page.tsx:**
    1. Add import: `import { useTranslations } from 'next-intl';`
    2. Add `const t = useTranslations('portal');` and `const tc = useTranslations('common');`
    3. Replace all hardcoded French strings:
       - 'Commande reçue' → `t('status.received')`
       - 'En cours de travail' → `t('status.working')`
       - 'Travail terminé' → `t('status.done')`
       - 'Prêt à récupérer' → `t('status.ready')`
       - 'Livré' → `t('status.delivered')`
       - 'Maintenant' → `t('now')`
       - 'Veuillez entrer un numéro de téléphone ou de commande.' → `t('errors.enterPhoneOrOrder')`
       - 'Aucune commande trouvée.' → `t('errors.noOrdersFound')`
       - 'Une erreur est survenue.' → `t('errors.generic')`
       - 'Erreur de connexion. Veuillez réessayer.' → `t('errors.connectionError')`
       - 'Recherche...' / 'Rechercher' → `t('searching')` / `t('search')`
    4. Add corresponding portal.* keys to both locale JSON files

    **Part B: Comprehensive codebase sweep**

    Run a thorough grep across ALL .tsx files to find ANY remaining hardcoded strings:

    ```bash
    # French strings
    grep -rn '"Chargement\|"Réessayer\|"Aucun\|"Retour\|"Commande\|"Tableau\|"Nouvelle\|"Charge de\|"Archivées\|"Non assigné\|"Article ajouté\|"Couturière\|"Gestionnaire\|"Administrateur\|"Sauvegarder\|"Supprimer\|"Modifier\|"Exporter\|"Ajouter\|"Fermer\|"Annuler\|"Confirmer\|"Enregistrer\|"Erreur\|"Rechercher\|"Filtrer\|"Requis\|"Optionnel\|"Accueil\|"Profil\|"Analyses\|"Vérifiez\|"Choisissez\|"Gérer\|"Rôle\|"Prêt\|"Livré\|"Terminé\|"En Attente\|"En Cours' src/ --include="*.tsx" | grep -v "node_modules" | grep -v ".d.ts"

    # English strings in UI (exclude imports, types, CSS classes, data attributes)
    grep -rn '>\s*Loading\|>\s*Try Again\|>\s*Unassigned\|>\s*Delete\|>\s*Export\|>\s*Cancel\|>\s*Save\|>\s*Close\|>\s*Board\|>\s*List\|>\s*Home\|>\s*Profile\|>\s*Orders\|>\s*Analytics\|>\s*Check your email\|>\s*Choose how' src/ --include="*.tsx" | grep -v "node_modules" | grep -v ".d.ts"

    # Also check for common patterns that might contain hardcoded strings
    grep -rn "title='\|title=\"\|placeholder='\|placeholder=\"\|aria-label='\|aria-label=\"" src/ --include="*.tsx" | grep -v "node_modules" | grep -v "{t(" | grep -v "{tc("
    ```

    For EACH remaining hardcoded string found:
    1. Check if a translation key already exists in the JSON files
    2. If yes: replace the string with t() call
    3. If no: add the key to BOTH en.json and fr.json, then use t()

    **Part C: JSON file sync validation**

    After all changes, validate both JSON files:
    ```bash
    # Verify valid JSON
    node -e "JSON.parse(require('fs').readFileSync('locales/en.json','utf8')); console.log('en.json valid')"
    node -e "JSON.parse(require('fs').readFileSync('locales/fr.json','utf8')); console.log('fr.json valid')"

    # Deep key comparison
    node -e "
      const en = JSON.parse(require('fs').readFileSync('locales/en.json','utf8'));
      const fr = JSON.parse(require('fs').readFileSync('locales/fr.json','utf8'));
      function getKeys(obj, prefix='') {
        return Object.entries(obj).flatMap(([k,v]) =>
          typeof v === 'object' && v !== null ? getKeys(v, prefix+k+'.') : [prefix+k]
        );
      }
      const enKeys = new Set(getKeys(en));
      const frKeys = new Set(getKeys(fr));
      const missingInFr = [...enKeys].filter(k => !frKeys.has(k));
      const missingInEn = [...frKeys].filter(k => !enKeys.has(k));
      if (missingInFr.length) console.log('Missing in fr.json:', missingInFr);
      if (missingInEn.length) console.log('Missing in en.json:', missingInEn);
      if (!missingInFr.length && !missingInEn.length) console.log('Keys in sync! Total:', enKeys.size);
    "
    ```

    Fix any key mismatches found.

    **Part D: Build verification**

    ```bash
    npm run build
    ```

    If build fails, fix all errors until it passes.
  </action>
  <verify>
    - `npm run build` completes successfully
    - Deep key comparison shows en.json and fr.json are in sync
    - grep sweep returns zero hardcoded French/English strings in .tsx files (excluding non-display contexts like imports, types, etc.)
    - Track page and print tasks page have translation hooks
  </verify>
  <done>
    Zero hardcoded user-facing strings remain in any .tsx file. Both en.json and fr.json have identical key structures. Build passes. Track page and print tasks page translated.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
    Complete EN/FR language toggle implementation across the entire Hotte Couture application:
    - Language toggle in header (desktop and mobile)
    - Cookie-based locale persistence
    - ~400+ translation keys in both en.json and fr.json
    - All 25+ pages and 67+ components migrated from hardcoded strings to t() calls
    - Board, intake wizard, admin, client, portal, navigation, dashboard, auth, payments all translated
  </what-built>
  <how-to-verify>
    1. Run `npm run dev` and open http://localhost:3000

    2. **Test language toggle visibility:**
       - Verify EN/FR toggle visible in header on desktop
       - Resize to mobile width — verify toggle visible in mobile header

    3. **Test 10 critical pages — toggle EN then FR on EACH, verify zero mixed-language text:**

       **Page 1: Board** (http://localhost:3000/board)
       - Title, column headers (Pending/Working/Done/Ready/Delivered), menu items (Workload, Archived, Export), "New Order" button
       - Pass: ALL visible text switches language. Zero French when EN selected, zero English when FR selected.

       **Page 2: Intake Step 1 - Client** (http://localhost:3000/intake)
       - Step titles in sidebar, form labels, language dropdown display text
       - Pass: Step names and form labels fully translate.

       **Page 3: Intake Step 3 - Articles** (navigate to step 3 in intake)
       - Category dropdowns, "Delete" buttons, service names, toast on add
       - Pass: All dropdowns and buttons translate.

       **Page 4: Intake Step 4 - Pricing** (navigate to step 4)
       - Pricing labels, rush order text, due date label
       - Pass: All pricing UI text translates.

       **Page 5: Admin Pricing** (http://localhost:3000/admin/pricing)
       - Page title, description, table headers (Name, Category, Price, Description, Minutes, Icon)
       - Pass: All 6 table headers and page title translate.

       **Page 6: Admin Team** (http://localhost:3000/admin/team)
       - Role labels, modal text
       - Pass: Role labels translate.

       **Page 7: Admin Measurements** (http://localhost:3000/admin/measurements)
       - Loading state, retry button, empty category message
       - Pass: Loading and empty states translate.

       **Page 8: Client Detail** (http://localhost:3000/clients/[any-id])
       - "Back to Clients" link, empty order/measurement states, order number format
       - Pass: Navigation and empty states translate.

       **Page 9: Order History** (http://localhost:3000/orders/history)
       - Status dropdown options (Pending, Working, Done, Ready, Delivered)
       - Pass: All 5 status options translate.

       **Page 10: Portal** (http://localhost:3000/portal)
       - Status timeline labels, search button, error messages
       - Pass: All portal text translates.

    4. **Also spot-check:**
       - Navigation sidebar/bottom nav labels (Board, Intake, Clients, Calendar, Dashboard, etc.)
       - Calendar page toast messages and "Assign to Me" button
       - Dashboard section titles (Profile, Orders, Analytics)

    5. **Cookie persistence:**
       - Set to EN, navigate between 3+ different pages — stays EN
       - Close browser tab, reopen — stays EN
       - Switch to FR — stays FR across pages

    **PASS CRITERIA:** All 10 critical pages show zero mixed-language text when toggled. Navigation labels translate. Cookie persists across navigation and refresh. If ANY page shows mixed language (some EN + some FR), describe which text did not change and on which page.
  </how-to-verify>
  <resume-signal>Type "approved" if all 10 pages pass (zero mixed-language text on toggle), or list the specific pages and strings that remain untranslated</resume-signal>
</task>

</tasks>

<verification>
1. `npm run build` passes
2. Both JSON files valid and key-synced
3. Zero hardcoded strings in grep sweep
4. Human verification: toggle works on every page, all text translates, language persists
</verification>

<success_criteria>
- EN/FR toggle visible and functional on every page
- Switching language updates ALL visible text immediately via router.refresh()
- Zero hardcoded user-facing strings remain in any .tsx file
- en.json and fr.json have identical key structures
- Language preference persists across navigation and refresh via NEXT_LOCALE cookie
- All 25 pages render correctly in both languages
- Build passes (npm run build)
</success_criteria>

<output>
After completion, create `.planning/phases/23-full-en-fr-language-toggle/23-06-SUMMARY.md`
</output>
