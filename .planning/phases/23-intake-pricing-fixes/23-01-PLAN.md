---
phase: 23-intake-pricing-fixes
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/app/api/garment-types/route.ts
  - src/components/rush-orders/rush-indicator.tsx
  - src/components/intake/pricing-step.tsx
autonomous: true

must_haves:
  truths:
    - "Garment type dropdown shows 'Sur mesure' and 'Alteration' category headers instead of 'Home'"
    - "Rush timeline shows meaningful text like 'Service express: 2 jours' instead of '0 days faster'"
    - "Rush labels display in French with clear rush terminology"
  artifacts:
    - path: "src/app/api/garment-types/route.ts"
      provides: "French category labels mapping"
      contains: "Sur mesure"
    - path: "src/components/rush-orders/rush-indicator.tsx"
      provides: "Improved rush timeline display with French text"
      contains: "jour"
  key_links:
    - from: "src/app/api/garment-types/route.ts"
      to: "garment-services-step.tsx dropdown"
      via: "categories object in JSON response"
      pattern: "categories.*sur_mesure|alteration"
    - from: "src/components/rush-orders/rush-indicator.tsx"
      to: "src/components/intake/pricing-step.tsx"
      via: "RushOrderTimeline component"
      pattern: "RushOrderTimeline"
---

<objective>
Fix garment category labels and rush service labels in the intake flow.

Purpose: Users see wrong category headers ("Home" instead of "Sur mesure") in the garment type dropdown, and rush timeline shows confusing text like "0 days faster than standard". Both are display/labelling issues that confuse the seamstresses using the iPad.

Output: Correct French category labels in garment type dropdown and meaningful French rush timeline text.
</objective>

<execution_context>
@/Users/aymanbaig/.claude/get-shit-done/workflows/execute-plan.md
@/Users/aymanbaig/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/23-intake-pricing-fixes/23-RESEARCH.md

@src/app/api/garment-types/route.ts
@src/components/rush-orders/rush-indicator.tsx
@src/components/intake/pricing-step.tsx
@src/components/intake/garment-services-step.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix garment category labels to French business terminology</name>
  <files>src/app/api/garment-types/route.ts</files>
  <action>
  In `src/app/api/garment-types/route.ts`, update the hardcoded `categories` object in the GET response (lines 61-69) to use correct French business terminology:

  Replace the current categories mapping:
  ```
  categories: {
    womens: "Women's Clothing",
    mens: "Men's Clothing",
    outerwear: 'Outerwear',
    formal: 'Formal Wear',
    activewear: 'Activewear',
    home: 'Home Textiles',
    outdoor: 'Outdoor Gear',
    other: 'Other',
  }
  ```

  With French labels matching the business context:
  ```
  categories: {
    womens: 'Vêtements femmes',
    mens: 'Vêtements hommes',
    outerwear: 'Manteaux',
    formal: 'Tenue de soirée',
    activewear: 'Vêtements de sport',
    home: 'Sur mesure',
    outdoor: 'Extérieur',
    other: 'Autre',
    alteration: 'Retouches',
  }
  ```

  Key changes:
  - `home` label changed from "Home Textiles" to "Sur mesure" (custom design) per client request
  - Added `alteration: 'Retouches'` category for alteration-type garments
  - All labels now in French to match UI language

  Also update the garment-services-step.tsx dropdown display (line 669) which currently uses `category.charAt(0).toUpperCase() + category.slice(1).replace('_', ' ')` as a fallback label. This fallback transforms the raw category key into a display name. The API already returns a `categories` mapping, but the dropdown renders `groupedTypes` keyed by raw category strings from the database. The fix is to use the `categories` mapping from the API response to get proper labels.

  In `garment-services-step.tsx`, the component already fetches from `/api/garment-types` and receives `data.groupedTypes` (lines 167-169). It does NOT currently store the `categories` mapping. Add state to store the categories mapping and use it for display:

  Actually, looking more closely, the simplest fix is in the API response only. The dropdown in garment-services-step.tsx line 669 displays: `{category.charAt(0).toUpperCase() + category.slice(1).replace('_', ' ')}` where `category` is the raw DB key (e.g., "home", "mens"). This is a fallback display. The categories mapping in the API response is NOT used by the dropdown.

  **TWO changes needed:**

  1. In `src/app/api/garment-types/route.ts`: Update the `categories` mapping as described above.

  2. In `src/components/intake/garment-services-step.tsx`: The category headers in the dropdown (line 668-669) currently show the raw DB category key with basic capitalization. Store the categories map from the API response and use it for display labels. In `loadGarmentTypes()` (around line 157-176), the component already receives `data.groupedTypes` but does NOT store `data.categories`. Add a new state `const [categoryLabels, setCategoryLabels] = useState<Record<string, string>>({})` near line 96. In `loadGarmentTypes`, after setting groupedTypes, also do `setCategoryLabels(data.categories || {})`. Then at line 669, replace:
  ```
  {category.charAt(0).toUpperCase() + category.slice(1).replace('_', ' ')}
  ```
  with:
  ```
  {categoryLabels[category] || category.charAt(0).toUpperCase() + category.slice(1).replace('_', ' ')}
  ```
  This way the French labels from the API are used, with the old formatting as fallback.
  </action>
  <verify>
  Run `npx tsc --noEmit` to verify TypeScript compiles. Visually confirm in dev mode that the garment type dropdown shows "Sur mesure" instead of "Home" and shows "Retouches" for alteration category.
  </verify>
  <done>Garment type dropdown category headers display correct French labels: "Sur mesure" for home/custom, "Retouches" for alterations, all other categories in French.</done>
</task>

<task type="auto">
  <name>Task 2: Fix rush timeline labels to show meaningful French text</name>
  <files>src/components/rush-orders/rush-indicator.tsx, src/components/intake/pricing-step.tsx</files>
  <action>
  Fix the `RushOrderTimeline` component in `src/components/rush-orders/rush-indicator.tsx` (lines 138-185) to:

  1. **Show French text instead of English.** Replace all English strings:
     - "Timeline:" → "Délai:"
     - "X days" → "X jour(s)"
     - "X days faster than standard" → "X jour(s) plus rapide"

  2. **Fix "0 days faster" edge case.** When `estimatedDays - rushDays === 0`, don't show the "faster" line at all. Only show the faster comparison when the difference is >= 1. When difference is 0, show "Service express" instead.

  3. **Update the rush comparison text logic** (lines 177-182):
     - If `estimatedDays - rushDays >= 1`: Show `"⚡ {diff} jour(s) plus rapide"`
     - If `estimatedDays - rushDays === 0`: Show `"⚡ Service express"` (no comparison)

  4. In `src/components/intake/pricing-step.tsx`, the rush fee radio button labels (lines 304-305, 323-324) already have decent French text ("Service express - 30,00$ (1-2 jours plus rapide)"). These are fine.

  5. Also in the `RushOrderTimeline`, change the "day/days" display (line 172) from English to French:
     ```
     {rushDays} jour{rushDays !== 1 ? 's' : ''}
     ```

  Keep all other rush components (`RushIndicator`, `RushRibbon`, `RushOrderCard`, `RushOrderPricing`) unchanged - they use config text ("RUSH"/"URGENT") which is fine as-is for badge display.
  </action>
  <verify>
  Run `npx tsc --noEmit` to verify TypeScript compiles. Test in dev that checking "Ceci est un service express" with small rush type shows a timeline like "2 jours" with "⚡ Service express" or "⚡ X jour(s) plus rapide" (never "0 days faster").
  </verify>
  <done>Rush timeline shows French text with "jour(s)" units, no more "0 days faster than standard", edge cases handled with "Service express" fallback.</done>
</task>

</tasks>

<verification>
1. Open the intake flow in dev mode
2. Go to garment selection step - verify dropdown category headers show French labels ("Sur mesure", "Retouches", "Vêtements femmes", etc.)
3. Proceed to pricing step, enable rush service
4. Verify rush timeline shows French text ("X jour(s)") and never shows "0 days faster"
5. Run `npx tsc --noEmit` - must compile clean
</verification>

<success_criteria>
- Garment dropdown categories display "Sur mesure" (not "Home") and "Retouches" (alteration category)
- Rush timeline text is in French using "jour(s)"
- No "0 days faster" text visible anywhere
- TypeScript compiles clean
</success_criteria>

<output>
After completion, create `.planning/phases/23-intake-pricing-fixes/23-01-SUMMARY.md`
</output>
