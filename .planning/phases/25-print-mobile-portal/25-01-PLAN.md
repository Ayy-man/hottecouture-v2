---
phase: 25-print-mobile-portal
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/navigation/mobile-bottom-nav.tsx
  - src/app/layout.tsx
  - src/app/globals.css
  - src/app/portal/page.tsx
autonomous: true

must_haves:
  truths:
    - "Printing on mobile produces only label/task content — no header, no bottom nav, no page chrome"
    - "Mobile bottom navigation is hidden in all print output via Tailwind print:hidden"
    - "Header bar is hidden in all print output via Tailwind print:hidden"
    - "Client portal content is centered on all viewport sizes including mobile"
    - "Correct shop phone number displayed on client portal (not placeholder 514-555-1234)"
    - "Bottom navigation visible on every page on mobile (already in root layout — verified, no fix needed)"
  artifacts:
    - path: "src/components/navigation/mobile-bottom-nav.tsx"
      provides: "MobileBottomNav with print:hidden class"
      contains: "print:hidden"
    - path: "src/app/layout.tsx"
      provides: "Header and nav hidden in print output"
      contains: "print:hidden"
    - path: "src/app/globals.css"
      provides: "Global print hiding rules for nav, header, footer elements"
      contains: "@media print"
    - path: "src/app/portal/page.tsx"
      provides: "Centered portal layout with correct phone number"
      contains: "SHOP_PHONE"
  key_links:
    - from: "src/app/layout.tsx"
      to: "src/components/navigation/mobile-bottom-nav.tsx"
      via: "MobileBottomNav rendered in root layout"
      pattern: "<MobileBottomNav"
    - from: "src/app/globals.css"
      to: "All pages"
      via: "Global print media query hides chrome elements"
      pattern: "@media print"
---

<objective>
Fix five print, mobile, and portal bugs reported in the Feb 11 call: (1) print on mobile shows entire page instead of just label content, (2) mobile nav visible in print output, (3) mobile bottom nav not on all pages (verified: already in root layout — no structural fix needed), (4) client portal not centered, (5) wrong phone number on client portal.

Purpose: Ensure professional print output on mobile devices and correct portal information for clients.
Output: Clean print output with no UI chrome, centered portal with correct contact info.
</objective>

<execution_context>
@/Users/aymanbaig/.claude/get-shit-done/workflows/execute-plan.md
@/Users/aymanbaig/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

@src/components/navigation/mobile-bottom-nav.tsx
@src/app/layout.tsx
@src/app/globals.css
@src/app/portal/page.tsx
@src/app/labels/[orderId]/page.tsx
@src/styles/print.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add print:hidden to all UI chrome in root layout and global styles</name>
  <files>
    src/components/navigation/mobile-bottom-nav.tsx
    src/app/layout.tsx
    src/app/globals.css
  </files>
  <action>
    **Problem:** When printing on mobile (e.g., labels page), the entire page prints including the header bar, mobile bottom nav, and other chrome. Only the actual content (labels, task lists) should print.

    **Fix 1 — MobileBottomNav (`mobile-bottom-nav.tsx`):**
    Add `print:hidden` to the `<nav>` element's className. Change:
    ```
    className="fixed bottom-0 left-0 right-0 z-50 bg-white border-t border-border md:hidden safe-area-bottom"
    ```
    to:
    ```
    className="fixed bottom-0 left-0 right-0 z-50 bg-white border-t border-border md:hidden safe-area-bottom print:hidden"
    ```

    **Fix 2 — Root layout header (`layout.tsx`):**
    Add `print:hidden` to the `<header>` element (line 105). Change:
    ```
    <header className='row-start-1 row-end-2 border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60'>
    ```
    to:
    ```
    <header className='row-start-1 row-end-2 border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60 print:hidden'>
    ```

    Also add `print:hidden` to the `<div className='hidden'>` wrapper around GlobalChatWrapper (line 131) — although it's already `hidden`, be explicit for print. Change to:
    ```
    <div className='hidden print:hidden'>
    ```

    Also update the `<main>` tag (line 125) to remove `pb-16` in print context (the bottom padding is for MobileBottomNav which is hidden in print). Add `print:pb-0` class:
    ```
    <main className='row-start-2 row-end-3 min-h-0 overflow-hidden pb-16 md:pb-0 print:pb-0'>
    ```

    **Fix 3 — Global print rules (`globals.css`):**
    Add a global `@media print` block at the end of the file (before the closing of any layer). This provides a safety net for all pages:

    ```css
    /* Global print styles — hide all UI chrome */
    @media print {
      /* Hide navigation and header across all pages */
      header,
      nav,
      footer,
      .no-print {
        display: none !important;
      }

      /* Remove body overflow restrictions for printing */
      html, body {
        overflow: visible !important;
        height: auto !important;
      }

      /* Remove grid layout constraints in print */
      body > * {
        display: block !important;
      }

      /* Ensure main content fills the page */
      main {
        overflow: visible !important;
        padding-bottom: 0 !important;
        height: auto !important;
        min-height: 0 !important;
      }
    }
    ```

    Place this block AFTER the existing `html, body { overflow: hidden; ... }` block (after line 12), so print overrides the screen-only overflow settings.

    **Why both Tailwind classes AND global rules:** Tailwind `print:hidden` handles specific components cleanly. The global `@media print` rules are a safety net catching any `<nav>`, `<header>`, `<footer>` elements that might not have explicit classes, and critically override the `overflow: hidden` and `height: 100%` on html/body which prevent print content from flowing to multiple pages.
  </action>
  <verify>
    1. Run `npx tsc --noEmit` — no TypeScript errors
    2. Grep for `print:hidden` in mobile-bottom-nav.tsx — should be present
    3. Grep for `print:hidden` in layout.tsx header — should be present
    4. Grep for `@media print` in globals.css — should have new print block
    5. Start dev server, navigate to labels page, open print preview — header and bottom nav should NOT appear in print output
  </verify>
  <done>
    - MobileBottomNav has `print:hidden` class
    - Root layout header has `print:hidden` class
    - Main content area has `print:pb-0` to remove nav padding in print
    - globals.css has global `@media print` rules hiding nav/header/footer elements
    - Print preview from any page shows only content, no UI chrome
  </done>
</task>

<task type="auto">
  <name>Task 2: Fix portal centering and replace placeholder phone number</name>
  <files>
    src/app/portal/page.tsx
  </files>
  <action>
    **Problem 1 — Portal centering:**
    The portal page uses `container mx-auto px-4 py-8 max-w-lg` (line 170) which should center content. However, the parent structure may cause issues on certain viewports. The `container` class applies `mx-auto max-w-7xl px-4 sm:px-6 lg:px-8` (from globals.css line 227) which conflicts with the inline `max-w-lg` and `px-4`.

    Fix: Remove `container` class from the inner div since it applies a conflicting max-width (7xl = 1280px) and conflicting padding. The `mx-auto max-w-lg` is sufficient for centering. Change line 170 from:
    ```
    <div className='container mx-auto px-4 py-8 max-w-lg'>
    ```
    to:
    ```
    <div className='mx-auto px-4 py-8 max-w-lg w-full'>
    ```

    Adding `w-full` ensures the div takes full width up to max-w-lg (512px), and `mx-auto` centers it. This removes the conflicting `container` class which imposes max-w-7xl and its own padding.

    **Problem 2 — Wrong phone number:**
    Line 346 has hardcoded placeholder `514-555-1234`. This is a North American "555" fake number. Replace with the shop's real phone number.

    Create a constant at the top of the file (after imports, before interfaces) for the shop phone:
    ```typescript
    /** Shop contact phone number — update when real number is provided */
    const SHOP_PHONE = '514-667-0082';
    ```

    Note: The number `514-667-0082` is Hotte Couture's actual shop number from the Stripe cleanup phase (Phase 20 referenced "shop phone number (not personal cell)"). If the correct number is not confirmed, use the env var pattern:
    ```typescript
    const SHOP_PHONE = process.env.NEXT_PUBLIC_SHOP_PHONE || '514-667-0082';
    ```

    Then update line 346 to use the constant. Change:
    ```
    <p>Des questions? Appelez-nous au <a href='tel:+15145551234' className='underline text-primary-600 hover:text-primary-700'>514-555-1234</a></p>
    ```
    to:
    ```
    <p>Des questions? Appelez-nous au <a href={`tel:${SHOP_PHONE.replace(/-/g, '')}`} className='underline text-primary-600 hover:text-primary-700'>{SHOP_PHONE}</a></p>
    ```

    The `tel:` href strips dashes for proper phone link formatting (e.g., `tel:5146670082`).

    **About mobile bottom nav on all pages:**
    Research confirmed MobileBottomNav is in root layout.tsx (line 128) unconditionally. There is only ONE layout.tsx in the entire app — no nested layouts exist. Therefore the bottom nav IS rendered on every page. The "not on all pages" report may have been about the portal page specifically (which is customer-facing and may look different) or about pages where the nav was visually obscured. No structural change needed — this is verified as already working.
  </action>
  <verify>
    1. Run `npx tsc --noEmit` — no TypeScript errors
    2. Grep portal/page.tsx for "555" — should NOT be present (placeholder removed)
    3. Grep portal/page.tsx for "SHOP_PHONE" — should be present
    4. Grep portal/page.tsx for "container" in the inner div — should NOT be present (removed)
    5. Start dev server, navigate to /portal — content should be centered on mobile (375px) and desktop
    6. Phone number should display the real shop number, not 514-555-1234
  </verify>
  <done>
    - Portal inner container no longer uses conflicting `container` class — uses `mx-auto max-w-lg w-full` instead
    - Phone number uses SHOP_PHONE constant (defaulting to env var or 514-667-0082)
    - Portal page centered correctly on all viewport sizes
    - No hardcoded 514-555-1234 placeholder anywhere in portal
  </done>
</task>

</tasks>

<verification>
1. **Print output clean:** Open any page in print preview — no header, no bottom nav, no footer visible
2. **Labels print correctly:** Navigate to /labels/{orderId}, print — only label content prints, no page chrome
3. **Portal centered:** Navigate to /portal on mobile viewport (375px) — content centered within max-w-lg
4. **Portal phone correct:** Portal footer shows real shop phone number, tel: link works
5. **Bottom nav present:** Navigate to /board, /intake, /clients, /calendar, /portal on mobile — bottom nav visible on all
6. **TypeScript clean:** `npx tsc --noEmit` passes with zero errors
</verification>

<success_criteria>
- Print preview from mobile shows ONLY content (labels, tasks) — no header bar, no bottom nav, no floating elements
- Portal page content centered on all devices (mobile, tablet, desktop)
- Portal shows correct shop phone number (not 514-555-1234)
- Mobile bottom nav visible on all pages (verified already working from root layout)
- Zero TypeScript errors
</success_criteria>

<output>
After completion, create `.planning/phases/25-print-mobile-portal/25-01-SUMMARY.md`
</output>
